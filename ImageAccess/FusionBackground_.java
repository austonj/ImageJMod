import java.awt.*;import java.util.*;import java.text.*;import ij.*;import ij.gui.*;import ij.process.*;/** * <hr> * <p><b>Plugin of ImageJ:</b><br> * FFT<br> * * <p><b>Author:</b><br> * Daniel Sage <a href="mailto:daniel.sage@epfl.ch?subject=SNR Plugin">daniel.sage@epfl.ch</a><br> * Swiss Federal Institute of Technology Lausanne, * Biomedical Imaging Group, * CH-1015 Lausanne, Switzerland, * <a href="http://bigwww.epfl.ch">http://bigwww.epfl.ch/</a><br> * * <p><b>Version:</b><br> * 3 September 2006<br> * * <p><b>Copyright</b><br> * Copyright © 2006, Swiss Federal Institute of Technology, Lausanne, Switzerland, (EPFL)<br> * * <hr> * */ 	public class FusionBackground_ {	public FusionBackground_() {			ImagePlus imp = WindowManager.getCurrentImage();		if (imp == null) {			IJ.error("No open image.");			return;		}				GenericDialog gd = new GenericDialog("Fusion Background");		gd.addNumericField("Threshold Low",  100, 0);		gd.addNumericField("Threshold High", 200, 0);		String list[] = getListImage();		gd.addChoice("Background image", list, list[0]);		gd.showDialog();		if (gd.wasCanceled())			return;		double tl = gd.getNextNumber();		double th = gd.getNextNumber();		String name = gd.getNextChoice();				ImageAccess input  = new ImageAccess(imp.getProcessor());		ImagePlus back = WindowManager.getImage(name);		if (back == null) {			IJ.error("No open image.");			return;		}		ImageAccess backgd = new ImageAccess(back.getProcessor());		int nx = backgd.getWidth();		int ny = backgd.getHeight();				if (nx != imp.getWidth()) {			IJ.error("Incompatible size of image.");			return;		}		if (ny != imp.getHeight()) {			IJ.error("Incompatible size of image.");			return;		}		ImageAccess out = CodeClass.fusionBackground(input, backgd, tl, th);		out.show("Fusion Background [" + tl + "," + th + "]" );			}	private String[] getListImage() {			int[] wList = WindowManager.getIDList();		if (wList==null) {			IJ.error("No images are open.");			return null;		}		String[] list = new String[wList.length];		for (int i=0; i<wList.length; i++) {			ImagePlus imp1 = WindowManager.getImage(wList[i]);			list[i] = imp1.getTitle();		}		return list;	}}